
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://blockstream.github.io/greenlight/tutorials/testing/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../self-hosting/">
      
      
      <link rel="icon" href="../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.39">
    
    
      
        <title>Testing your app - Greenlight Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Testing your app - Greenlight Documentation" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://blockstream.github.io/greenlight/assets/images/social/tutorials/testing.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://blockstream.github.io/greenlight/tutorials/testing/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Testing your app - Greenlight Documentation" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://blockstream.github.io/greenlight/assets/images/social/tutorials/testing.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#testing-your-application" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Greenlight Documentation" class="md-header__button md-logo" aria-label="Greenlight Documentation" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Greenlight Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Testing your app
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Blockstream/greenlight" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/" class="md-tabs__link">
          
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/" class="md-tabs__link">
          
  
    
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../about/" class="md-tabs__link">
          
  
    
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Greenlight Documentation" class="md-nav__button md-logo" aria-label="Greenlight Documentation" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    Greenlight Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Blockstream/greenlight" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Home
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../getting-started/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/certs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get a developer certificate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/register/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Registering a node
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/schedule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Starting a node
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/recover/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recover access
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Testing your app
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Testing your app
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-test-and-what-to-test" class="md-nav__link">
    <span class="md-ellipsis">
      Why test and what to test?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-gl-testing-testing-framework" class="md-nav__link">
    <span class="md-ellipsis">
      The gl-testing testing framework
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git" class="md-nav__link">
    <span class="md-ellipsis">
      Git
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protoc" class="md-nav__link">
    <span class="md-ellipsis">
      protoc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-your-local-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare your local environment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-your-first-test" class="md-nav__link">
    <span class="md-ellipsis">
      Write your first test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manually-testing-against-a-mock-network" class="md-nav__link">
    <span class="md-ellipsis">
      Manually testing against a mock Network
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../self-hosting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self-Hosting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/client-libraries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client Libraries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/creds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/node-domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node Domain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/testserver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testserver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/certs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Certificates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/lsp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LSP Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/webhooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Webhooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/pairing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pairing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../about/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    About
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frequently Asked Questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-test-and-what-to-test" class="md-nav__link">
    <span class="md-ellipsis">
      Why test and what to test?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-gl-testing-testing-framework" class="md-nav__link">
    <span class="md-ellipsis">
      The gl-testing testing framework
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git" class="md-nav__link">
    <span class="md-ellipsis">
      Git
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protoc" class="md-nav__link">
    <span class="md-ellipsis">
      protoc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-your-local-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare your local environment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-your-first-test" class="md-nav__link">
    <span class="md-ellipsis">
      Write your first test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manually-testing-against-a-mock-network" class="md-nav__link">
    <span class="md-ellipsis">
      Manually testing against a mock Network
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="testing-your-application">Testing your Application</h1>
<div class="admonition example">
<p class="admonition-title">In this tutorial you will learn how to:</p>
<ul>
<li>Build and use the testing <a href="https://www.docker.com/">Docker</a> image</li>
<li>Set up a test network with Core Lightning nodes</li>
<li>Use the Greenlight test framework <code>gl-testing</code></li>
<li>Write a simple test that utilizes a Greenlight node</li>
<li>Start a python REPL that lets you manually test against <code>gl-testing</code></li>
</ul>
</div>
<h2 id="why-test-and-what-to-test">Why test and what to test?</h2>
<p>You have just written the next viral app on top of Greenlight, how do
you ensure it</p>
<ol>
<li>works now?</li>
<li>keeps on working going forward?</li>
</ol>
<p>You could manually test your application after each change against the
Greenlight servers, or you might even automate some of these, but they
still run against the production environment. This is likely not as 
fast as you're used to for local tests, and it actually allocates 
resources on the Greenlight service that someone will have to pay for.</p>
<p>It would undoubtedly be better if we had a way to test our application
locally and in reproducible way. Well, fortunately, Greenlight 
provides a testing framework that helps you do just that.</p>
<h2 id="the-gl-testing-testing-framework">The <code>gl-testing</code> testing framework</h2>
<p>The Greenlight <a href="https://github.com/Blockstream/greenlight">repository</a> comes with a "Batteries Included" 
testing framework that you can use to test your application locally.
The testing framework <code>gl-testing</code> is based on <a href="https://github.com/ElementsProject/lightning/tree/master/contrib/pyln-testing">pyln-testing</a>
which is also used in the development of Core Lightning itself.</p>
<p>The components of <code>gl-testing</code> allow you to:</p>
<ul>
<li>Construct an arbitrarily complex network of lightning nodes.</li>
<li>Set up a local mock of the Greenlight services.</li>
<li>Use the provided pyln-fixtures for sophisticated test setups.</li>
<li>Test your application in a repeatable and reproducible manner.</li>
<li>Keep you system clean of development dependencies.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Deviations in behavior between <code>gl-testing</code> and the production environment</p>
<p>We keep track of the substantial differences in the behavior of 
<code>gl-testing</code> and the production system in the 
<a href="https://github.com/Blockstream/greenlight/tree/main/libs/gl-testing#differences-between-greenlight-and-gl-testing"><code>gl-testing</code> readme</a></p>
</div>
<p>This tutorial will walk you through the necessary steps to write a 
test that registers a new Greenlight client with the <code>gl-testing</code> 
testing framework that issues an invoice from the newly registered 
Greenlight node.
You will also learn how to start a REPL that you can use to manually
execute commands against the testing framework or your application</p>
<h2 id="prerequisites">Prerequisites</h2>
<h4 id="git">Git</h4>
<p>The <code>gl-testing</code> testing framework is part of the Greenlight github
<a href="https://github.com/Blockstream/greenlight">repository</a>. To get a local working copy of the Greenlight
repository you need <code>git</code> installed on your system. See the 
<a href="https://github.com/git-guides/install-git">git-guides</a> for a detailed instruction on how to install
<code>git</code> on your system.</p>
<h4 id="protoc">protoc</h4>
<p>The later section <code>Manually testing against a mock Network</code> requires us
to build the <code>gl-client</code> on the host system. Greenlight uses <a href="https://grpc.io/">grpc</a>
for the communication between the client and the node, therefor you need 
the Protobuf compiler <code>protoc</code> present on our machine. Check out
<a href="https://grpc.io/docs/protoc-installation/">protoc</a> for instructions on how to install <code>protoc</code> on your
system.</p>
<h4 id="docker">Docker</h4>
<p>Testing a Greenlight application is dependency intensive. We need 
different versions of Core Lightning to be present besides a bunch of
python packages, rust and cargo, as well as a compiler for proto 
files. To help you keep your development environment clean, the 
<code>gl-testing</code> testing framework comes with a <strong>Dockerfile</strong> that includes 
all the necessary dependencies and allows you to run all the tests in 
the shell of the assembled Docker image.</p>
<p>You need a working Docker installation on your system in order to 
build and use the Docker image. See the <a href="https://docs.docker.com/engine/install/">Docker manual</a>
for instructions on how to set up Docker on your operating system.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Testing in the docker images is optional for Linux hosts, but strongly
suggested due to the rather large number of dependencies. For Windows
and MacOS we only support testing in the docker image, since 
Core Lightning only ships pre-compiled versions for Linux on 
<code>x86_64</code> for now.</p>
</div>
<h2 id="prepare-your-local-environment">Prepare your local environment</h2>
<p>Before we can dive into testing with the <code>gl-testing</code> testing
framework we need to get a local working copy of the repository.</p>
<div class="copy highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:Blockstream/greenlight.git<span class="w"> </span>gl-testing-tutorial
</code></pre></div>
<p>For the rest of the tutorial we will work within the repository
we just cloned.
<div class="copy highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>gl-testing-tutorial
</code></pre></div></p>
<p>The Greenlight repository comes with a <code>Makefile</code> that holds some 
useful targets for us. We make use of this to build a Docker image 
<code>gltesting</code> that contains all the dependencies required to run the 
testing framework <code>gl-testing</code>.
<div class="copy highlight"><pre><span></span><code>make<span class="w"> </span>docker-image
</code></pre></div></p>
<p>Now we are all set and to drop into a shell that hold all the 
required dependencies to work with <code>gl-testing</code>.
<div class="copy highlight"><pre><span></span><code>make<span class="w"> </span>docker-shell
</code></pre></div>
You can always exit the docker-shell by calling <code>exit</code> from the shell 
or by pressing <code>Ctrl-D</code>.</p>
<div class="admonition info">
<p class="admonition-title">Self testing</p>
<p>You will probably have expected this, but we also use <code>gl-testing</code>
to test the <code>gl-client</code> bindings themselves. If you are working on
a pull request for the <code>gl-client</code> or another component, 
<code>gl-testing</code> allows you to test your changes locally before 
submitting them.</p>
</div>
<h2 id="write-your-first-test">Write your first test</h2>
<p>Tests in <code>gl-testing</code> work best if you have a programmatic way of
driving your client. This could either be your own testing framework,
e.g., having a method to trigger a button press in your UI, or by
exposing your own API. In this example we will walk through a simple 
test that</p>
<ol>
<li>Sets up a small test network</li>
<li>Starts a Greenlight node</li>
<li>Opens a channel from the network to the Greenlight node</li>
<li>Creates an invoice on the Greenlight node</li>
<li>Pays the invoice from a node in the network</li>
</ol>
<pre class="mermaid"><code>flowchart LR
    A((CLN 1)) === B((CLN 2));
    B === C((GL 1));
    A -. payment .-&gt; C;</code></pre>
<p>We start by creating our test file <code>my-first-test.py</code> in the root of 
our <code>gl-testing-tutorial</code> directory. The <code>gl-testing</code> testing 
framework uses the <a href="https://docs.pytest.org/en/7.2.x/"><code>pytest</code></a> framework under the hood, so writing test
should be familiar for the python developers amongst you.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">my-first-test.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">test_invoice_payment</span><span class="p">(</span><span class="n">node_factory</span><span class="p">,</span> <span class="n">clients</span><span class="p">,</span> <span class="n">bitcoind</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Here we import our test fixtures and create a simple test that just
prints <code>"Hello World!"</code> to the standard output. Any function that 
starts with <code>test_</code> will be picked up by the test runner and executed.
The arguments are fixtures (see <a href="https://docs.pytest.org/en/7.2.x/">pytest</a> for further details)
that are passed to and can be used by the test.</p>
<p>Let's check if we can properly import the <code>gl-testing</code> fixtures in our
test. To run the test we need to drop to the shell of the Docker
image we created above.</p>
<div class="highlight"><pre><span></span><code>make<span class="w"> </span>docker-shell
</code></pre></div>
<p>Before we can run any tests that require parts of Greenlight, such as 
the <code>gl-client</code>, the <code>gl-plugin</code> or any of the bindings, we need to
build those components from the Docker shell.</p>
<div class="highlight"><pre><span></span><code>make<span class="w"> </span>build-self
</code></pre></div>
<p>In the shell we execute the <code>pytest</code> command to run the test. We add
the flags <code>-v</code> for a verbose output and <code>-s</code> to print all output to
the console instead of capturing it.</p>
<div class="highlight"><pre><span></span><code>pytest -v -s my-first-test.py
</code></pre></div>
<p>This should produce a lot of output, with the last few lines reading 
something along the lines of
<div class="no-copy highlight"><pre><span></span><code>Hello<span class="w"> </span>World!
PASSED
BitcoinRpcProxy<span class="w"> </span>shut<span class="w"> </span>down<span class="w"> </span>after<span class="w"> </span>processing<span class="w"> </span><span class="m">0</span><span class="w"> </span>requests
Calling<span class="w"> </span>stop<span class="w"> </span>with<span class="w"> </span>arguments<span class="w"> </span><span class="o">()</span>
Result<span class="w"> </span><span class="k">for</span><span class="w"> </span>stop<span class="w"> </span>call:<span class="w"> </span>Bitcoin<span class="w"> </span>Core<span class="w"> </span><span class="nv">stopping</span>


<span class="o">============================================================</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>passed<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">4</span>.10s<span class="w"> </span><span class="o">=============================================================</span>
</code></pre></div></p>
<p>Great! We have written our very first test. However, our test is still
fairly useless, let's replace it with something actually meaningful.</p>
<p>As a first step, we create a small network of Core Lightning nodes to 
which we will connect our Greenlight node later on.
Fortunately, <code>pyln-testing</code> provides us with some fixtures that handle
common tasks for us. We can use this fixture to start and control 
non-Greenlight nodes.</p>
<p><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">my-first-test.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">test_invoice_payment</span><span class="p">(</span><span class="n">node_factory</span><span class="p">,</span> <span class="n">clients</span><span class="p">,</span> <span class="n">bitcoind</span><span class="p">):</span>
<span class="hll">    <span class="c1"># Create 2-node-network (l1)----(l2)</span>
</span><span class="hll">    <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">node_factory</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span class="hll">    <span class="n">l2</span><span class="o">.</span><span class="n">fundwallet</span><span class="p">(</span><span class="n">sats</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
Here we used the <code>node_factory</code> fixture to create a <code>line-graph</code> 
network consisting of two Core Lightning nodes <code>l1</code> and <code>l2</code> that 
already have a channel established between them. The nodes have an 
integrated rpc client that we can use to fund the <code>l2</code> node with 
<code>2000000sat</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip: Use your IDEs autocompletion</p>
<p>If you want to use the <strong>autocompletion</strong> features of your IDE you
need to select the python interpreter form the environment set by 
poetry in <code>libs/gl-testing</code>. You can then import the classes from 
the fixtures and annotate the fixtures with its types.
e.g. 
<div class="no-copy highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="n">Clients</span>
<span class="kn">from</span> <span class="nn">pyln.testing.fixtures</span> <span class="kn">import</span> <span class="n">NodeFactory</span><span class="p">,</span> <span class="n">LightningNode</span>
<span class="o">...</span>
<span class="k">def</span> <span class="nf">test_xyz</span><span class="p">(</span><span class="n">node_factory</span><span class="p">:</span> <span class="n">NodeFactory</span><span class="p">,</span> <span class="n">clients</span><span class="p">:</span> <span class="n">Clients</span><span class="p">):</span>
    <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">LightningNode</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_factory</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>
</code></pre></div></p>
</div>
<p>Now we can finally start to deal with Greenlight. We use the <code>clients</code> 
fixture to create a new client, along with its own directory, signer 
secret, and certificates. After that we can call the 
<code>Client.register()</code> method to register the client with Greenlight and
and <code>Client.node()</code> to schedule and return the Greenlight node that 
belongs to the registered client. The <code>configure=True</code> argument tells
the client to store the client certificates.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">my-first-test.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">test_invoice_payment</span><span class="p">(</span><span class="n">node_factory</span><span class="p">,</span> <span class="n">clients</span><span class="p">,</span> <span class="n">bitcoind</span><span class="p">):</span>
    <span class="c1"># Create 2-node-network (l1)----(l2)</span>
    <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">node_factory</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">l2</span><span class="o">.</span><span class="n">fundwallet</span><span class="p">(</span><span class="n">sats</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>

<span class="hll">    <span class="c1"># Register a new Greenlight client.</span>
</span><span class="hll">    <span class="n">c</span> <span class="o">=</span> <span class="n">clients</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
</span><span class="hll">    <span class="n">c</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">configure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span class="hll">    <span class="n">gl1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">node</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
<p><strong>Congratulations</strong>, we have our first Greenlight node up and running on
the testing framework! </p>
<p>Let's connect our Greenlight node to the 
network now. To do so we need to establish a channel between our
Greenlight node and the network. We choose the <code>l2</code> node as the entry
point for our Greenlight node. Funding the channel between <code>l2</code> and 
<code>gl</code> requires us to connect to <code>l2</code> and to fund a channel. The 
connection handshake as well as the channel funding and eventually the
creation of an invoice require the presence of a signer for the node.
Greenlight signers run on the client side to keep the custody on the
users side. We first need to start the client signer so that the node
can request signatures from the signer.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">my-first-test.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">test_invoice_payment</span><span class="p">(</span><span class="n">node_factory</span><span class="p">,</span> <span class="n">clients</span><span class="p">,</span> <span class="n">bitcoind</span><span class="p">):</span>
    <span class="c1"># Create 2-node-network (l1)----(l2)</span>
    <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">node_factory</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">l2</span><span class="o">.</span><span class="n">fundwallet</span><span class="p">(</span><span class="n">sats</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>

    <span class="c1"># Register a new Greenlight client.</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">clients</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">configure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">node</span><span class="p">()</span>

<span class="hll">    <span class="c1"># Start signer and connect to (l2)</span>
</span><span class="hll">    <span class="n">s</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">signer</span><span class="p">()</span><span class="o">.</span><span class="n">run_in_thread</span><span class="p">()</span>
</span><span class="hll">    <span class="n">gl1</span><span class="o">.</span><span class="n">connect_peer</span><span class="p">(</span><span class="n">l2</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;127.0.0.1:</span><span class="si">{</span><span class="n">l2</span><span class="o">.</span><span class="n">daemon</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>We are almost there! Now we fund a channel between <code>l2</code> and <code>gl</code>. We 
import a helper function 
<code class="highlight"><span class="kn">from</span> <span class="nn">pyln.testing.utils</span> <span class="kn">import</span> <span class="n">wait_for</span></code> that helps us to wait
for the channel to be established.This will poll <code>gl1</code> for its channel
states and return as soon as the state indicates that the channel is 
confirmed and fully functional.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">my-first-test.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="o">*</span>
<span class="hll"><span class="kn">from</span> <span class="nn">pyln.testing.utils</span> <span class="kn">import</span> <span class="n">wait_for</span>
</span>
<span class="k">def</span> <span class="nf">test_invoice_payment</span><span class="p">(</span><span class="n">node_factory</span><span class="p">,</span> <span class="n">clients</span><span class="p">,</span> <span class="n">bitcoind</span><span class="p">):</span>
    <span class="c1"># Create 2-node-network (l1)----(l2)</span>
    <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">node_factory</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">l2</span><span class="o">.</span><span class="n">fundwallet</span><span class="p">(</span><span class="n">sats</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>

    <span class="c1"># Register a new Greenlight client.</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">clients</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">configure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">node</span><span class="p">()</span>

    <span class="c1"># Start signer and connect to (l2)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">signer</span><span class="p">()</span><span class="o">.</span><span class="n">run_in_thread</span><span class="p">()</span>
    <span class="n">gl1</span><span class="o">.</span><span class="n">connect_peer</span><span class="p">(</span><span class="n">l2</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;127.0.0.1:</span><span class="si">{</span><span class="n">l2</span><span class="o">.</span><span class="n">daemon</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="hll">    <span class="c1"># Fund a channel (l2)----(gl).</span>
</span><span class="hll">    <span class="c1"># This results in the following network</span>
</span><span class="hll">    <span class="c1"># (l1)----(l2)----(gl)</span>
</span><span class="hll">    <span class="n">l2</span><span class="o">.</span><span class="n">rpc</span><span class="o">.</span><span class="n">fundchannel</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">node_id</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="c1"># Generate a block to synchronize and proceed</span>
</span><span class="hll">    <span class="c1"># with the channel funding.</span>
</span><span class="hll">    <span class="n">bitcoind</span><span class="o">.</span><span class="n">generate_block</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wait_for_mempool</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span class="hll">    <span class="c1"># Wait for the channel to confirm.</span>
</span><span class="hll">    <span class="n">wait_for</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
</span><span class="hll">        <span class="n">gl1</span><span class="o">.</span><span class="n">list_peers</span><span class="p">()</span><span class="o">.</span><span class="n">peers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s1">&#39;CHANNELD_NORMAL&#39;</span>
</span><span class="hll">    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Before we create and pay the invoice we also need to wait for the 
gossip to reach every node. Otherwise the invoice will be lacking
route hints as it assumes its only channel to be a dead end.
Alternatively we could also create the invoice directly and wait for 
<code>l1</code> to have a full view of our small network but lets go with the 
first option this time. We again use the <code>wait_for</code> function. The
successor function checks that we see 4 channel entries in our view
of the network as both channels are bidirectional.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">my-first-test.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyln.testing.utils</span> <span class="kn">import</span> <span class="n">wait_for</span>

<span class="k">def</span> <span class="nf">test_invoice_payment</span><span class="p">(</span><span class="n">node_factory</span><span class="p">,</span> <span class="n">clients</span><span class="p">,</span> <span class="n">bitcoind</span><span class="p">):</span>
    <span class="c1"># Create 2-node-network (l1)----(l2)</span>
    <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">node_factory</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">l2</span><span class="o">.</span><span class="n">fundwallet</span><span class="p">(</span><span class="n">sats</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>

    <span class="c1"># Register a new Greenlight client.</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">clients</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">configure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">node</span><span class="p">()</span>

    <span class="c1"># Start signer and connect to (l2)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">signer</span><span class="p">()</span><span class="o">.</span><span class="n">run_in_thread</span><span class="p">()</span>
    <span class="n">gl1</span><span class="o">.</span><span class="n">connect_peer</span><span class="p">(</span><span class="n">l2</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;127.0.0.1:</span><span class="si">{</span><span class="n">l2</span><span class="o">.</span><span class="n">daemon</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Fund a channel (l2)----(gl).</span>
    <span class="c1"># This results in the following network</span>
    <span class="c1"># (l1)----(l2)----(gl)</span>
    <span class="n">l2</span><span class="o">.</span><span class="n">rpc</span><span class="o">.</span><span class="n">fundchannel</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">node_id</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="c1"># Generate a block to synchronize and proceed</span>
    <span class="c1"># with the channel funding.</span>
    <span class="n">bitcoind</span><span class="o">.</span><span class="n">generate_block</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wait_for_mempool</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Wait for the channel to confirm.</span>
    <span class="n">wait_for</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
        <span class="n">gl1</span><span class="o">.</span><span class="n">list_peers</span><span class="p">()</span><span class="o">.</span><span class="n">peers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s1">&#39;CHANNELD_NORMAL&#39;</span>
    <span class="p">)</span>

<span class="hll">    <span class="c1"># Wait for all channels to appear in our view of the network. We </span>
</span><span class="hll">    <span class="c1"># don&#39;t even have to wait for our channel to appear in l1s </span>
</span><span class="hll">    <span class="c1"># gossip: We can give a hint as soon as we know that our channel </span>
</span><span class="hll">    <span class="c1"># is not a dead end. We wait for 4 entries in our gossmap as both </span>
</span><span class="hll">    <span class="c1"># channels are bidirectional.</span>
</span><span class="hll">    <span class="n">bitcoind</span><span class="o">.</span><span class="n">generate_block</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span class="hll">    <span class="n">wait_for</span><span class="p">(</span>
</span><span class="hll">        <span class="k">lambda</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gl1</span><span class="o">.</span><span class="n">list_channels</span><span class="p">()</span><span class="o">.</span><span class="n">channels</span><span class="p">])</span> <span class="o">==</span> <span class="mi">4</span> 
</span><span class="hll">    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Now we can finally create and pay an invoice. We create an invoice on
the Greenlight node and pay it with the <code>l1</code> node routed via the <code>l2</code>
node. To create the invoice we import the core-lightning proto stubs
<code>clnpb</code> from the Greenlight client <code>glclient</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">my-first-test.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyln.testing.utils</span> <span class="kn">import</span> <span class="n">wait_for</span>
<span class="hll"><span class="kn">from</span> <span class="nn">glclient</span> <span class="kn">import</span> <span class="n">clnpb</span>
</span>
<span class="k">def</span> <span class="nf">test_invoice_payment</span><span class="p">(</span><span class="n">node_factory</span><span class="p">,</span> <span class="n">clients</span><span class="p">,</span> <span class="n">bitcoind</span><span class="p">):</span>
    <span class="c1"># Create 2-node-network (l1)----(l2)</span>
    <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">node_factory</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">l2</span><span class="o">.</span><span class="n">fundwallet</span><span class="p">(</span><span class="n">sats</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>

    <span class="c1"># Register a new Greenlight client.</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">clients</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">configure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">node</span><span class="p">()</span>

    <span class="c1"># Start signer and connect to (l2)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">signer</span><span class="p">()</span><span class="o">.</span><span class="n">run_in_thread</span><span class="p">()</span>
    <span class="n">gl1</span><span class="o">.</span><span class="n">connect_peer</span><span class="p">(</span><span class="n">l2</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;127.0.0.1:</span><span class="si">{</span><span class="n">l2</span><span class="o">.</span><span class="n">daemon</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Fund a channel (l2)----(gl).</span>
    <span class="c1"># This results in the following network</span>
    <span class="c1"># (l1)----(l2)----(gl)</span>
    <span class="n">l2</span><span class="o">.</span><span class="n">rpc</span><span class="o">.</span><span class="n">fundchannel</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">node_id</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="c1"># Generate a block to synchronize and proceed</span>
    <span class="c1"># with the channel funding.</span>
    <span class="n">bitcoind</span><span class="o">.</span><span class="n">generate_block</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wait_for_mempool</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Wait for the channel to confirm.</span>
    <span class="n">wait_for</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
        <span class="n">gl1</span><span class="o">.</span><span class="n">list_peers</span><span class="p">()</span><span class="o">.</span><span class="n">peers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s1">&#39;CHANNELD_NORMAL&#39;</span>
    <span class="p">)</span>

    <span class="c1"># Wait for all channels to appear in our view of the network. We </span>
    <span class="c1"># don&#39;t even have to wait for our channel to appear at the gossmap</span>
    <span class="c1"># of l1: We can give a hint as soon as we know that our channel is </span>
    <span class="c1"># not a dead end. We wait for 4 entries in our gossmap as both </span>
    <span class="c1"># channels are bidirectional.</span>
    <span class="n">bitcoind</span><span class="o">.</span><span class="n">generate_block</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">wait_for</span><span class="p">(</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gl1</span><span class="o">.</span><span class="n">list_channels</span><span class="p">()</span><span class="o">.</span><span class="n">channels</span><span class="p">])</span> <span class="o">==</span> <span class="mi">4</span> 
    <span class="p">)</span>

<span class="hll">    <span class="c1"># Create an invoice.</span>
</span><span class="hll">    <span class="n">bolt11</span> <span class="o">=</span> <span class="n">gl1</span><span class="o">.</span><span class="n">invoice</span><span class="p">(</span>
</span><span class="hll">        <span class="n">amount_msat</span><span class="o">=</span><span class="n">clnpb</span><span class="o">.</span><span class="n">AmountOrAny</span><span class="p">(</span><span class="n">amount</span><span class="o">=</span><span class="n">clnpb</span><span class="o">.</span><span class="n">Amount</span><span class="p">(</span><span class="n">msat</span><span class="o">=</span><span class="mi">100000</span><span class="p">)),</span>
</span><span class="hll">        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;test-desc&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">label</span> <span class="o">=</span><span class="s2">&quot;test-label&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="p">)</span><span class="o">.</span><span class="n">bolt11</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1"># Pay invoice.</span>
</span><span class="hll">    <span class="n">l1</span><span class="o">.</span><span class="n">rpc</span><span class="o">.</span><span class="n">pay</span><span class="p">(</span><span class="n">bolt11</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p><strong>Congratulations</strong>! You have written your first test using the 
<code>gl-testing</code> testing framework and a Greenlight node. Our test creates
a small line graph network consisting of 3 lightning nodes with a 
Greenlight node at the end. We created an invoice on the Greenlight
node and payed for it with the first node in line.</p>
<p>Let's check if our test passes!</p>
<p>Remember that we need to call the tests from our docker shell
<div class="highlight"><pre><span></span><code>make<span class="w"> </span>docker-shell
</code></pre></div></p>
<p>We can start our <code>pytest</code> test now. Remember the options <code>-v</code> and <code>-s</code>
to print the logs to stdout instead of capturing them. 
<div class="highlight"><pre><span></span><code>pytest<span class="w"> </span>-vs<span class="w"> </span>my-first-test.py
</code></pre></div></p>
<p>After the test is finished you should see <code>passed</code> in the terminal.
<div class="highlight"><pre><span></span><code><span class="o">==========================================</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>passed<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">30</span>.83s<span class="w"> </span><span class="o">===========================================</span>
</code></pre></div></p>
<h2 id="manually-testing-against-a-mock-network">Manually testing against a mock Network</h2>
<p>Every once in a while you'll want to either step through an existing
test, or have a small test that just sets up a network topology, and
then drops you in a shell that you can use to interact with the
network. In both cases <code>breakpoint()</code> is your friend.</p>
<p>You also can use a <code>breakpoint()</code> to set up a <code>gltesting</code> environment
that you can work against from your host.</p>
<p>The following test will set up a small lightning network, and then 
drops us in a <a href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a> that we can use to inspect the setup, and to 
drive changes such as paying an invoice or funding a channel. Note 
that we also import and pass the <code>scheduler</code> <code>directory</code> fixtures to
the test so that we can access them from our REPL:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">examples/setup_repl.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">gltesting.fixtures</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">test_setup</span><span class="p">(</span><span class="n">clients</span><span class="p">,</span> <span class="n">node_factory</span><span class="p">,</span> <span class="n">scheduler</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">bitcoind</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets up a gltesting backend and a small lightning network.</span>

<span class="sd">    This is meant to be run from inside the docker shell. See the </span>
<span class="sd">    gltesting tutorial for further info.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">l3</span> <span class="o">=</span> <span class="n">node_factory</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># (1)!</span>

    <span class="c1"># Assuming we want interact with l3 we&#39;ll want to print</span>
    <span class="c1"># its contact details:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;l3 details: </span><span class="si">{</span><span class="n">l3</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> @ 127.0.0.1:</span><span class="si">{</span><span class="n">l3</span><span class="o">.</span><span class="n">daemon</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;export GL_CA_CRT=</span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">/certs/ca.pem&quot;</span><span class="p">)</span>  <span class="c1"># (4)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;export GL_NOBODY_CRT=</span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">/certs/users/nobody.crt&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;export GL_NOBODY_KEY=</span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">/certs/users/nobody-key.pem&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;export GL_SCHEDULER_GRPC_URI=https://localhost:</span><span class="si">{</span><span class="n">scheduler</span><span class="o">.</span><span class="n">grpc_port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (3)!</span>

    <span class="nb">breakpoint</span><span class="p">()</span>  <span class="c1"># (2)!</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>At this point we have a network with 3 nodes in a line.</li>
<li>Opens a REPL that accepts Python code.</li>
<li>Tells us which port the mock scheduler is listening on</li>
<li>Prints the location of the keypairs and certificates to use when
    talking to the mock scheduler</li>
</ol>
<p>To run this test we first need to drop into the Docker shell.
<div class="highlight"><pre><span></span><code>make<span class="w"> </span>docker-shell
</code></pre></div></p>
<p>Then we can start our REPL form inside the docker-shell.
<div class="highlight"><pre><span></span><code>pytest<span class="w"> </span>-s<span class="w"> </span>examples/setup_repl.py
</code></pre></div></p>
<p>You will see an output that looks similar to the following lines:
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pytest<span class="w"> </span>-s<span class="w"> </span>testy.py
<span class="o">==========</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>session<span class="w"> </span><span class="nv">starts</span><span class="w"> </span><span class="o">==========</span>
platform<span class="w"> </span>linux<span class="w"> </span>--<span class="w"> </span>Python<span class="w"> </span><span class="m">3</span>.8.10,<span class="w"> </span>pytest-7.2.1,<span class="w"> </span>pluggy-1.0.0
rootdir:<span class="w"> </span>/repo
plugins:<span class="w"> </span>cov-3.0.0,<span class="w"> </span>xdist-2.5.0,<span class="w"> </span>forked-1.6.0,<span class="w"> </span>timeout-2.1.0
collected<span class="w"> </span><span class="m">1</span><span class="w"> </span>item

testy.py<span class="w"> </span>Running<span class="w"> </span>tests<span class="w"> </span><span class="k">in</span><span class="w"> </span>/tmp/ltests-syfsnw83
<span class="o">[</span>...<span class="w"> </span>many<span class="w"> </span>more<span class="w"> </span>lines<span class="w"> </span>about<span class="w"> </span>the<span class="w"> </span>setup<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>network<span class="w"> </span>...<span class="o">]</span>

scheduler:<span class="w"> </span>https://localhost:44165
l3<span class="w"> </span>details:<span class="w"> </span>**node_id**<span class="w"> </span>@<span class="w"> </span><span class="m">127</span>.0.0.1:40261
<span class="nb">export</span><span class="w"> </span><span class="nv">GL_CA_CRT</span><span class="o">=</span>/tmp/gltesting/**tmpdir**/certs/ca.pem
<span class="nb">export</span><span class="w"> </span><span class="nv">GL_NOBODY_CRT</span><span class="o">=</span>/tmp/gltesting/**tmpdir**/certs/users/nobody.crt
<span class="nb">export</span><span class="w"> </span><span class="nv">GL_NOBODY_KEY</span><span class="o">=</span>/tmp/gltesting/**tmpdir**/certs/users/nobody-key.pem
<span class="nb">export</span><span class="w"> </span><span class="nv">GL_SCHEDULER_GRPC_URI</span><span class="o">=</span>https://localhost:**scheduler_port**

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<span class="w"> </span>PDB<span class="w"> </span>set_trace<span class="w"> </span>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
--Return--
&gt;<span class="w"> </span>/repo/testy.py<span class="o">(</span><span class="m">20</span><span class="o">)</span>test_my_network<span class="o">()</span>-&gt;None
-&gt;<span class="w"> </span>breakpoint<span class="o">()</span>
<span class="o">(</span>pdb<span class="o">)</span>
</code></pre></div></p>
<p>At this point we have a REPL that we can use to drive changes 
interactively, by writing python code, just like we'd do if we were 
writing the test in a file.</p>
<p>We now want to attach a client application from the host to the mock 
scheduler. Therefore we first need to set a number of environment 
variables on our host, that the <code>gl-client</code> library will pick up and 
use. Just copy the following lines from your docker-shell:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">GL_CA_CRT</span><span class="o">=</span>/tmp/gltesting/**tmpdir**/certs/ca.pem
<span class="nb">export</span><span class="w"> </span><span class="nv">GL_NOBODY_CRT</span><span class="o">=</span>/tmp/gltesting/**tmpdir**/certs/users/nobody.crt
<span class="nb">export</span><span class="w"> </span><span class="nv">GL_NOBODY_KEY</span><span class="o">=</span>/tmp/gltesting/**tmpdir**/certs/users/nobody-key.pem
<span class="nb">export</span><span class="w"> </span><span class="nv">GL_SCHEDULER_GRPC_URI</span><span class="o">=</span>https://localhost:**scheduler_port**
</code></pre></div>
<p>The first three lines tell the client library which identity to load
itself, and how to verify the identity of the scheduler when
connecting. These must match the lines printed above. The last line
tells the client to connect to our mock scheduler instead of the
production scheduler, the port must match the one printed above.</p>
<div class="admonition question">
<p class="admonition-title">Why is this random?</p>
<p>We usually run tests in parallel, which requires that we isolate
the tests from each other. If we did not randomize the ports and
directories, we could end up with tests that interfere with each
other, making debugging much harder, and resulting in flaky tests.</p>
</div>
<p>We now can create a client on our host that we can mess around with.</p>
<p>Lets have a look at the following example application that we will
explain in more detail in another tutorial. You can find the file
in the repository under <code>examples/app_test.py</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">examples/app_test.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">glclient</span> <span class="kn">import</span> <span class="n">Scheduler</span><span class="p">,</span> <span class="n">Signer</span><span class="p">,</span> <span class="n">TlsConfig</span><span class="p">,</span><span class="n">Node</span><span class="p">,</span> <span class="n">nodepb</span>

<span class="k">class</span> <span class="nc">GetInfoApp</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An example application for gltesting.</span>

<span class="sd">    This example application shows the process on how to register,</span>
<span class="sd">    scheduler and call against a gltesting environment greenlight </span>
<span class="sd">    node.</span>

<span class="sd">    To execute this example set up the docker gltesting environment,</span>
<span class="sd">    drop into a REPL as explained in the gltesting tutorial.</span>

<span class="sd">    Then run the test below outside the gltesting docker container</span>
<span class="sd">    (run it from the host).</span>
<span class="sd">    `pytest -s -v app_test.py::test_getinfoapp`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">network</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tls</span><span class="p">:</span> <span class="n">TlsConfig</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secret</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="n">secret</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="n">network</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="p">:</span> <span class="n">TlsConfig</span> <span class="o">=</span> <span class="n">tls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signer</span><span class="p">:</span> <span class="n">Signer</span> <span class="o">=</span> <span class="n">Signer</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">tls</span><span class="p">)</span> <span class="c1"># signer needs to keep running</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signer</span><span class="o">.</span><span class="n">node_id</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">scheduler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Scheduler</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a glclient Scheduler</span>

<span class="sd">        The scheduler is created from the attributes stored in this</span>
<span class="sd">        class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_or_recover</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Registers or recovers a node on gltesting</span>

<span class="sd">        Also sets the new identity after register/recover.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">()</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signer</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">()</span><span class="o">.</span><span class="n">recover</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signer</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">device_cert</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">device_key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nodepb</span><span class="o">.</span><span class="n">GetInfoResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Requests getinfo on the gltesting greenlight node&quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">()</span><span class="o">.</span><span class="n">schedule</span><span class="p">()</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">grpc_uri</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">get_info</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">test_getinfoapp</span><span class="p">():</span>
    <span class="c1"># These are normally persisted on disk and need to be loaded and</span>
    <span class="c1"># passed to the glclient library by the application. In this </span>
    <span class="c1"># example we store them directly in the &quot;app&quot;.</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">32</span>
    <span class="n">network</span><span class="o">=</span><span class="s1">&#39;regtest&#39;</span>
    <span class="n">tls</span> <span class="o">=</span> <span class="n">TlsConfig</span><span class="p">()</span>

    <span class="c1"># Register a node</span>
    <span class="n">giap</span> <span class="o">=</span> <span class="n">GetInfoApp</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">tls</span><span class="p">)</span>
    <span class="n">giap</span><span class="o">.</span><span class="n">register_or_recover</span><span class="p">()</span>

    <span class="c1"># GetInfo</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">giap</span><span class="o">.</span><span class="n">get_info</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;res=</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>This example application registers a node and requests <code>getinfo</code> on
the greenlight node. Let's check if we can run it agains our REPL
gltesting setup.</p>
<p>We need to switch to the example directory (on our host, not in the 
docker-shell) and activate the python environment that sets up all 
the necessary dependencies for the
example.</p>
<div class="highlight"><pre><span></span><code>poetry<span class="w"> </span>shell
</code></pre></div>
<div class="highlight"><pre><span></span><code>poetry<span class="w"> </span>install
</code></pre></div>
<p>The first command drops us into a <a href="https://python-poetry.org"><code>poetry</code></a>-shell, the second
installs the necessary dependencies from the <code>pyproject.toml</code> file.</p>
<p>With the REPL setup in the docker-shell and from the poetry-shell on 
the host we can now run our test application.</p>
<div class="highlight"><pre><span></span><code>pytest<span class="w"> </span>-s<span class="w"> </span>app_test.py::test_getinfoapp
</code></pre></div>
<p>If you now see something an output that looks similar to the following
lines, you made it! You successfully set up a <code>gltesting</code> greenlight
mock in the <code>docker-shell</code> an application against it from the host.</p>
<div class="highlight"><pre><span></span><code><span class="o">==================</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>session<span class="w"> </span><span class="nv">starts</span><span class="w"> </span><span class="o">==================</span>
...<span class="w">                                                        </span>
app_test.py::test_getinfoapp<span class="w"> </span><span class="nv">res</span><span class="o">=</span>id:<span class="w"> </span><span class="s2">&quot;\002\005\216\213l*\323c\354Y\252\023d)%mtQd\302\275\310\177\230\360\246\206\220\354,\\\233\013&quot;</span>
alias:<span class="w"> </span><span class="s2">&quot;VIOLENTSPAWN-v23.05gl1&quot;</span>
color:<span class="w"> </span><span class="s2">&quot;\002\005\216&quot;</span>
version:<span class="w"> </span><span class="s2">&quot;v23.05gl1&quot;</span>
lightning_dir:<span class="w"> </span><span class="s2">&quot;/tmp/gltesting/tmp/tmpdz6neih7/node-0/regtest&quot;</span>
our_features<span class="w"> </span><span class="o">{</span>
<span class="w">  </span>init:<span class="w"> </span><span class="s2">&quot;\010\240\210\n\&quot;i\242&quot;</span>
<span class="w">  </span>node:<span class="w"> </span><span class="s2">&quot;\210\240\210\n\&quot;i\242&quot;</span>
<span class="w">  </span>invoice:<span class="w"> </span><span class="s2">&quot;\002\000\000\002\002A\000&quot;</span>
<span class="o">}</span>
blockheight:<span class="w"> </span><span class="m">103</span>
network:<span class="w"> </span><span class="s2">&quot;regtest&quot;</span>
fees_collected_msat<span class="w"> </span><span class="o">{</span>
<span class="o">}</span>

<span class="nv">PASSED</span>

<span class="o">==================</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>passed<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.10s<span class="w"> </span><span class="o">==================</span>
</code></pre></div>
<p>All of this works thanks because we mount the <code>/tmp/gltesting</code> directory
from the host, allowing both, the docker container and host to exchange
files. The <code>docker-shell</code> also reuses the host network, allowing
clients or applications running on the host to talk directly to the 
scheduler and the nodes running in the docker container.</p>
<p>Once you are done testing, use <code>continue</code> or <code>Ctrl-D</code> in the REPL to
trigger a shutdown.</p>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "content.code.annotate", "navigation.instant", "navigation.tabs.sticky", "navigation.sections", "navigation.indexes", "content.tabs.link", "content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>